"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[33],{9033:function(e,t,i){i.r(t),i.d(t,{default:function(){return L}});var n=i(7437),o=i(7044),s=i(200),a=i(5803),r=i(2106),c=i(4295),l=i(9789),h=i(8558),d=i(2517),u=i(8768),m=i(5982),p=i(8394),_=i(4102),Z=i(9860),f=i(3914),w=i(2806),y=i(5567),C=i(7189),v=i(4426),b=i(2351),g=i(2265);let S=[{id:2302705,text:"Phase Now"},{id:2301221,text:"Phase One"},{id:2301244,text:"Phase Two"},{id:2453639,text:"Phase Three"},{id:2301245,text:"Phase Four"}];var I=i(9426),k=i(7720),T=i(1885);class E{_onClockTick(e){if(!this._enabled)return;let t=e._clockStep;if(this._looking&&this._changeHeadingPitch(t),-1===this._direction)return;let i=this._currentSpeed*t;this._continuousMotion?this._currentSpeed<0&&(this._currentSpeed/=this._forwardInertia):this._currentSpeed/=this._forwardInertia,0===this._direction?h.Z.multiplyByScalar(this._camera.direction,1,this.scratchCurrentDirection):1===this._direction?h.Z.multiplyByScalar(this._camera.direction,-1,this.scratchCurrentDirection):i=this._defaultSpeed*t,2===this._direction?h.Z.multiplyByScalar(this._camera.direction,1,this.scratchCurrentDirection):3===this._direction?h.Z.multiplyByScalar(this._camera.direction,-1,this.scratchCurrentDirection):4===this._direction?h.Z.multiplyByScalar(this._camera.right,-1,this.scratchCurrentDirection):5===this._direction?h.Z.multiplyByScalar(this._camera.right,1,this.scratchCurrentDirection):7===this._direction?h.Z.multiplyByScalar(this._camera.up,-1,this.scratchCurrentDirection):6===this._direction&&h.Z.multiplyByScalar(this._camera.up,1,this.scratchCurrentDirection),h.Z.multiplyByScalar(this.scratchCurrentDirection,i,this.scratchDeltaPosition);let n=this._camera.position;h.Z.add(n,this.scratchDeltaPosition,this.scratchNextPosition);let o=this._cesiumViewer.scene.globe,s=o.ellipsoid;s.cartesianToCartographic(this.scratchNextPosition,this.scratchNextCartographic);let a=o.getHeight(this.scratchNextCartographic);if(void 0===a){console.warn("height is undefined!");return}a<0&&console.warn("height is negative!"),s.cartographicToCartesian(this.scratchNextCartographic,this.scratchTerrainConsideredNextPosition),this._camera.setView({destination:this.scratchTerrainConsideredNextPosition,orientation:new I.Z(this._camera.heading,this._camera.pitch,this._camera.roll),endTransform:k.Z.IDENTITY}),.001>Math.abs(this._currentSpeed)&&(this._currentSpeed=0)}_connectEventHandlers(){let e=this._cesiumViewer.canvas;this._screenSpaceEventHandler=new c.Z(this._canvas),this._screenSpaceEventHandler.setInputAction(this._onMouseLButtonClicked.bind(this),b.Z.LEFT_DOWN),this._screenSpaceEventHandler.setInputAction(this._onMouseUp.bind(this),b.Z.LEFT_UP),this._screenSpaceEventHandler.setInputAction(this._onMouseMove.bind(this),b.Z.MOUSE_MOVE),this._screenSpaceEventHandler.setInputAction(this._onMouseLButtonDoubleClicked.bind(this),b.Z.LEFT_DOUBLE_CLICK),e.setAttribute("tabindex","0"),e.onclick=function(){e.focus()},e.addEventListener("keydown",this._onKeyDown.bind(this)),e.addEventListener("keyup",this._onKeyUp.bind(this)),e.addEventListener("wheel",this._onMouseWheel.bind(this)),this._cesiumViewer.clock.onTick.addEventListener(this._onClockTick,this)}_onMouseLButtonClicked(e){this._looking=!0,this._mousePosition=this._startMousePosition=h.Z.clone(e.position)}_onMouseWheel(e){this._continuousMotion?e.deltaY<0?this._currentSpeed+=-e.deltaY/(30*this._speedWheelSensitivity):this._currentSpeed+=-e.deltaY/(10*this._speedWheelSensitivity):this._currentSpeed+=-e.deltaY/this._speedWheelSensitivity,this._direction=0}_onMouseLButtonDoubleClicked(e){this._looking=!1,this._mousePosition=this._startMousePosition=h.Z.clone(e.position)}_onMouseUp(e){this._looking=!1}_onMouseMove(e){this._mousePosition=e.endPosition}_onKeyDown(e){let t=e.keyCode;switch(this._direction=-1,t){case 87:case 38:this._direction=2;return;case 83:case 40:this._direction=3;return;case 68:case 39:this._direction=5;return;case 65:case 37:this._direction=4;return;case 81:this._direction=7;return;case 69:this._direction=6;return;default:return}}_onKeyUp(){this._direction=-1}_changeHeadingPitch(e){let t=this._canvas.clientWidth,i=this._canvas.clientHeight,n=(this._mousePosition.x-this._startMousePosition.x)/t,o=-(this._mousePosition.y-this._startMousePosition.y)/i,s=m.Z.toDegrees(this._camera.heading),a=m.Z.toDegrees(this._camera.pitch)+3*o;a>176&&a<272?a=272:a>88&&a<272&&(a=88),this._camera.setView({orientation:{heading:m.Z.toRadians(s+3*n),pitch:m.Z.toRadians(a),roll:this._camera.roll}})}_enableDefaultScreenSpaceCameraController(e){let t=this._cesiumViewer.scene;t.screenSpaceCameraController.enableRotate=e,t.screenSpaceCameraController.enableTranslate=e,t.screenSpaceCameraController.enableZoom=e,t.screenSpaceCameraController.enableTilt=e,t.screenSpaceCameraController.enableLook=e}start(){return this._enabled=!0,this._enableDefaultScreenSpaceCameraController(!1),!0}stop(){this._enabled=!1,this._enableDefaultScreenSpaceCameraController(!0)}constructor(e){this._currentSpeed=0,this._forwardInertia=1.5,this._speedWheelSensitivity=900,this._continuousMotion=!0,this._defaultSpeed=.02,this._enabled=!1,this._cesiumViewer=e.cesiumViewer,this._canvas=this._cesiumViewer.canvas,this._camera=this._cesiumViewer.camera,this._connectEventHandlers(),this._looking=!1,this._direction=-1,this._screenSpaceEventHandler=!1,this.scratchCurrentDirection=new h.Z,this.scratchDeltaPosition=new h.Z,this.scratchNextPosition=new h.Z,this.scratchTerrainConsideredNextPosition=new h.Z,this.scratchNextCartographic=new T.Z}}o.Z.defaultAccessToken="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwMjA4MzkzMC0yMGNjLTQxZDItOTIwMC0yMTBiZWE5MTdlMjgiLCJpZCI6MTcwMDY5LCJpYXQiOjE2OTY0OTIwMDV9.Dhq09qaf06rBxQgzlRWU-6eis8i4LO26WFpyDmM0WDE";var L=()=>{let[e,t]=(0,g.useState)(!1),[i,o]=(0,g.useState)(!1),[I,k]=(0,g.useState)(),[T,L]=(0,g.useState)(),[x,D]=(0,g.useState)();return(0,g.useEffect)(()=>{(async()=>{try{let g=new s.Z("cesiumContainer",{terrainProvider:await (0,a.Z)(),timeline:!1,animation:!1,creditContainer:document.createElement("none")}),I=await r.Z.fromIonAssetId(2302705);g.scene.primitives.add(I),new c.Z(g.scene.canvas);let k=new l.Z({position:new h.Z(0,0,0),point:{pixelSize:100,color:d.Z.TRANSPARENT,outlineColor:d.Z.YELLOW,outlineWidth:2}});g.entities.add(k);let T=document.createElement("button");T.textContent="Reset Camera",T.classList.add("cesium-button"),T.addEventListener("click",()=>{P()}),g.container.appendChild(T);let L=document.createElement("button");L.textContent="Story Mode",L.classList.add("cesium-button"),g.container.appendChild(L);let x=document.createElement("select");x.id="toolbar",x.classList.add("cesium-button"),x.innerHTML="Phases",S.forEach(e=>{let t=document.createElement("option");t.value=e.id.toString(),t.textContent=e.text,x.appendChild(t)}),x.addEventListener("change",e=>{let t=e.target,i=parseInt(t.value);2302705==i?B():2301221==i?A():2301244==i?W():2453639==i?R():2301245==i&&H()}),document.addEventListener("keydown",function(e){q._enabled||("w"===e.key||"W"===e.key?g.camera.moveForward(.1):"s"===e.key||"S"===e.key?g.camera.moveBackward(.1):"a"===e.key||"A"===e.key?g.camera.moveLeft(.1):"d"===e.key||"D"===e.key?g.camera.moveRight(.1):"q"===e.key||"Q"===e.key?g.camera.moveUp(.1):("e"===e.key||"E"===e.key)&&g.camera.moveDown(.1))}),g.flyTo(I,{offset:new u.Z(m.Z.toRadians(-35),m.Z.toRadians(0),35)}),g.scene.screenSpaceCameraController.enableCollisionDetection=!1;var e=I.asset.extras;(0,p.Z)(e)&&(0,p.Z)(e.ion)&&(0,p.Z)(e.ion.defaultStyle)&&(I.style=new _.Z(e.ion.defaultStyle));let P=()=>{let e=g.scene.primitives;for(let t=0;t<e.length;t++){let i=e.get(t);i instanceof r.Z&&g.flyTo(i,{offset:new u.Z(m.Z.toRadians(-35),m.Z.toRadians(0),35)})}},O="data.json";var i={},n=0;let N=null,M=null;var o="";fetch(O).then(e=>e.json()).then(e=>{i=e,o="Phase Now",z(o),document.addEventListener("keyup",function(e){"Escape"===e.key&&(g.scene.camera.lookAtTransform(l),k.show=!1,t&&t.label&&(t.label.show=new y.Z(!1)),N&&N.label&&(N.label.show=new y.Z(!1)))});var t,s=null,a=null,r=null;let c=!0,l=g.scene.camera.transform.clone();g.screenSpaceEventHandler.setInputAction(function(e){g.scene.camera.lookAtTransform(l);var n,_=g.scene.pick(e.position);if((0,p.Z)(_)){s=(0,p.Z)(_.id)?null===(n=_.id.position)||void 0===n?void 0:n.getValue(C.Z.now()):g.scene.pickPosition(e.position),k.show=!1,t&&t.label&&(t.label.show=new y.Z(!1)),N&&N.label&&(N.label.show=new y.Z(!1));var b=h.Z.distance(g.camera.position,s),S=h.Z.multiplyByScalar(h.Z.normalize(h.Z.subtract(s,g.camera.position,new h.Z),new h.Z),.85*b,new h.Z),I=h.Z.multiplyByScalar(h.Z.normalize(h.Z.subtract(s,g.camera.position,new h.Z),new h.Z),.995*b,new h.Z);g.camera.flyTo({destination:h.Z.add(g.camera.position,S,new h.Z),orientation:{heading:g.camera.heading,pitch:g.camera.pitch,roll:g.camera.roll},duration:2}),k.position=new v.Z(h.Z.add(g.camera.position,I,new h.Z)),k.show=!0,g.scene.camera.lookAt(s,new u.Z(0,-m.Z.PI/8,1e6))}for(var T=0;T<i[o].locations.length;T++)a=h.Z.fromDegrees(i[o].locations[T].lon,i[o].locations[T].lat,i[o].locations[T].height),c&&(r=a,c=!1),M=g.entities.add({position:a,label:{text:i[o].locations[T].labeldesciption,show:!1,font:i[o].locations[T].font,fillColor:d.Z.WHITE,outlineColor:d.Z.BLACK,outlineWidth:2,style:Z.Z.FILL_AND_OUTLINE,verticalOrigin:f.Z.BOTTOM,pixelOffset:new w.Z(0,80),backgroundColor:d.Z.fromCssColorString("rgba(0,0,0,0.7)"),showBackground:!0,backgroundPadding:new w.Z(8,4),disableDepthTestDistance:Number.POSITIVE_INFINITY}}),s&&s.equals(a)&&a.equals(r)?(console.log(i[o].locations[T].labeldesciption),M&&M.label&&(M.label.show=new y.Z(!0)),t=M):s&&s.equals(a)&&!a.equals(r)&&(t&&t.label&&(t.label.show=new y.Z(!1)),M&&M.label&&(M.label.show=new y.Z(!0)),t=M)},b.Z.LEFT_DOUBLE_CLICK),null==L||L.addEventListener("click",function(){var e=window.innerWidth-800,t=window.innerHeight-400;window.open("https://ion.cesium.com/stories/viewer/?id=1d2c9453-2d53-4e90-8123-f14dbe176d11","_blank","width=".concat(e,",height=").concat(t,",left=").concat(40,",top=").concat(40))}),function(e){var t;let n=null===(t=i[o])||void 0===t?void 0:t.locations[e];if(!n)return;let s=h.Z.fromDegrees(n.lon,n.lat,n.height),a=g.camera.positionWC.clone(),r=new h.Z;h.Z.subtract(s,a,r);let c=n.distance;h.Z.normalize(r,r),h.Z.multiplyByScalar(r,c,r);let l=h.Z.add(s,r,new h.Z);N&&(g.entities.remove(N),N=null),(n.descriptions||n.image)&&(N=g.entities.add({position:s,label:{text:n.descriptions,show:!1,font:n.font,fillColor:d.Z.WHITE,outlineColor:d.Z.BLACK,outlineWidth:2,style:Z.Z.FILL_AND_OUTLINE,verticalOrigin:f.Z.BOTTOM,pixelOffset:new w.Z(0,40),backgroundColor:d.Z.fromCssColorString("rgba(0,0,0,0.7)"),showBackground:!0,backgroundPadding:new w.Z(8,4),disableDepthTestDistance:Number.POSITIVE_INFINITY},billboard:{image:n.image,show:!1,verticalOrigin:f.Z.BOTTOM,width:n.image_width,height:n.image_height,pixelOffset:new w.Z(0,n.pixelOffset)}})),1==i[o].locations[e].move?g.scene.camera.flyTo({destination:l,orientation:{heading:m.Z.toRadians(n.heading),pitch:m.Z.toRadians(n.pitch),roll:g.camera.roll},duration:3,complete:function(){}}):0==i[o].locations[e].move&&P()}(n)}).catch(e=>{console.error("Error fetching JSON:",e)});let B=async()=>{V();let e=await r.Z.fromIonAssetId(2302705);g.scene.primitives.add(e),P(),U(),o="Phase Now",z(o),n=0},A=async()=>{V();let e=await r.Z.fromIonAssetId(2301221);g.scene.primitives.add(e),P(),U(),o="Phase One",z(o),n=0},W=async()=>{V();let e=await r.Z.fromIonAssetId(2301244);g.scene.primitives.add(e),P(),U(),o="Phase Two",z(o),n=0},R=async()=>{V();let e=await r.Z.fromIonAssetId(2453639);g.scene.primitives.add(e),P(),U(),o="Phase Three",z(o),n=0},H=async()=>{V();let e=await r.Z.fromIonAssetId(2301245);g.scene.primitives.add(e),P(),U(),o="Phase Four",z(o),n=0},V=async()=>{let e=g.scene.primitives;for(let t=0;t<e.length;t++){let i=e.get(t);i instanceof r.Z&&(e.remove(i),t--)}},U=async()=>{N&&(g.entities.remove(N),N=null),g.entities.values.forEach(function(e){e.show=!1})},z=async e=>{fetch(O).then(e=>e.json()).then(t=>{for(var i in t)if(i==e&&t.hasOwnProperty(i))for(var n=t[i].locations,o=0;o<n.length;o++){var s=n[o];s.labeltext&&g.entities.add({position:h.Z.fromDegrees(s.lon,s.lat,s.height),point:{pixelSize:30,color:d.Z.fromCssColorString("rgba(0, 0, 0, 0.8)"),disableDepthTestDistance:Number.POSITIVE_INFINITY},label:{text:s.labeltext,font:"14px sans-serif",fillColor:d.Z.WHITE,style:Z.Z.FILL_AND_OUTLINE,outlineWidth:2,outlineColor:d.Z.WHITE,pixelOffset:new w.Z(0,0),eyeOffset:new h.Z(0,0,0),disableDepthTestDistance:Number.POSITIVE_INFINITY}})}}).catch(e=>{console.error("Error fetching JSON:",e)})},F=document.createElement("button");F.classList.add("cesium-button"),F.innerHTML="GraphMat",F.addEventListener("click",()=>{t(!0)});let Y=document.createElement("button");Y.textContent="Log Camera Config",Y.classList.add("cesium-button"),Y.addEventListener("click",()=>{let e=g.camera,t={position:{x:e.position.x,y:e.position.y,z:e.position.z},direction:{x:e.direction.x,y:e.direction.y,z:e.direction.z},up:{x:e.up.x,y:e.up.y,z:e.up.z},frustum:{fov:e.frustum.fov,aspectRatio:e.frustum.aspectRatio,near:e.frustum.near,far:e.frustum.far}},i=JSON.stringify(t,null,2);console.log(i);let n=new Blob([i],{type:"text/plain"}),o=URL.createObjectURL(n),s=document.createElement("a");s.href=o,s.download="cameraConfig.txt",document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(o)});let j=g.container.querySelector(".cesium-viewer-toolbar");if(j){let e=j.querySelector(".cesium-viewer-geocoderContainer");j.insertBefore(F,e)}j&&j.insertBefore(x,F),j&&j.insertBefore(T,x),j&&j.insertBefore(L,T),j&&j.insertBefore(Y,L);let q=new E({cesiumViewer:g});D(q),document.addEventListener("keypress",e=>{"f"==e.key&&q.start(),"g"==e.key&&q.stop()},!1)}catch(e){console.log(e)}})()},[]),(0,n.jsx)("div",{children:(0,n.jsx)("div",{id:"cesiumContainer"})})}}}]);